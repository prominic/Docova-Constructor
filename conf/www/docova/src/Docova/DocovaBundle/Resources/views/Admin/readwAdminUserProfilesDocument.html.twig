<!DOCTYPE HTML>
<html>
<head>
	<title>{%trans%}User Profile{%endtrans%}</title>
	<!--  common javascript & CSS header -->
	{% include 'DocovaBundle:Admin:sfWebAdminCommonScriptHeader.html.twig'%}
	<script type="text/javascript" src="{{ asset('bundles/docova/js/admin/adminUserProfile.js') }}"></script>
	<script type="text/javascript" src="{{ asset('bundles/docova/js/sarissa.js') }}"></script>
	<script type="text/javascript" src="{{ asset('bundles/docova/js/sarissa_ieemu_xpath.js') }}"></script>
	{% set path = path('docova_admin_readdocument', { 'view_name' : view_name, 'doc_id' : document.getId }) %}
	{% set path = (app.request.get('uType') == "user") ? path ~ '?uType=user' : path %}
	{% include 'DocovaBundle:Admin:sfWebAdminCommonFields.html.twig' with { 
		'document' : document, 
		'view_name' : view_name, 
		'view_title' : view_title, 
		'path_info' : path,
		'mode' : 'read'
	} %}
</head>
<body scroll="no">
	<ul class="ui-widget-header actionBar hidetoload">
		{% if document.getUsername != 'DOCOVA SE' or (user.getId == document.getId) %}
		<a id="editBtn" href="{{ path('docova_admin_editdocument', { 'view_name' : view_name, 'doc_id' : document.getId }) }}{{ app.request.get('uType') == 'user' ? '?uType=user' : '' }}">{% trans %}Edit Profile{% endtrans %}</a>
		{% endif %}
		{% if app.request.get('uType') != "user" %}
		<li id="closeBtn">{% trans %}Close{% endtrans %}</li>
		{% endif %}
	</ul>
	<div id="frmEmulator" class="hidetoload">
		<h3 class="adjusted headings1">{% trans %}User Profile Settings{% endtrans %}</h3>
		<div id="divFormContainer">
			<ul>
				<li><a href="#tabs-1">{%trans%}General{%endtrans%}</a></li>
				<li><a href="#tabs-2">{%trans%}User Experience{%endtrans%}</a></li>
				<li><a href="#tabs-3">{%trans%}Work{%endtrans%}</a></li>
				<li><a href="#tabs-4">{%trans%}Delegates{%endtrans%}</a></li>
			</ul>

			<div id="tabs-1">
				<table class="elmContainer" cellspacing="0">
					<tr>
						<td class="firstRw">{%trans%}First Name{%endtrans%}:</td>
						<td class="firstRw">{{ document.getUserProfile.getFirstName  }}</td>
					</tr>
					<tr>
						<td>{%trans%}Last Name{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getLastName }}</td>
					</tr>
					<tr>
						<td>{%trans%}User ID{%endtrans%}:</td>
						<td>
							{{ document.getUsername }}
							<span class="elNote">({%trans%}auto generated{%endtrans%})</span>
						</td>
					</tr>
					<tr>
						<td>{%trans%}User Role{%endtrans%}:</td>
						<td>
							{% set userRole = 'User' %}
							{% if document is defined %}
								{% for item in document.getUserRoles if item.getRole == 'ROLE_ADMIN' %}
									{% set userRole = 'Administrator' %}
								{% endfor %}
							{% endif %}
							{{ userRole|trans }}
						</td>
					</tr>
					<tr>
						<td>{%trans%}Account Type{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getAccountType ? 'DOCOVA (Internal)'|trans : 'LDAP Directory'|trans }}</td>
					</tr>
					<tr>
						<td>{%trans%}Email Address{%endtrans%}:</td>
						<td>{{ document.getUserMail }}</td>
					</tr>
					<tr>
						<td>{%trans%}My mail system{%endtrans%}:</td>
						<td>{% if document.getUserProfile.getUserMailSystem == 'N' %}Lotus Notes{% elseif document.getUserProfile.getUserMailSystem == 'O' %}Outlook{% elseif document.getUserProfile.getUserMailSystem == 'X' %}{%trans%}IMAP{%endtrans%}{% endif %}</td>
					</tr>
					{% if document.getUserProfile.getUserMailSystem == 'X' %}
					{% set mail_server = document.getUserProfile.getMailServerURL ? document.getUserProfile.getMailServerURL|split(':') : ['','993'] %} 
					{% set mail_server_port = mail_server[1] ? mail_server[1]|split('/') : [''] %}
					<tr>
						<td class="firstRw exc">{%trans%}Mail Server Url{%endtrans%}:</td>
						<td class="firstRw exc">
							{{ mail_server[0] }}
						</td>
					</tr>
					<tr>
						<td class="firstRw exc">{%trans%}Mail Server Port{%endtrans%}: </td>
						<td class="firstRw exc">
							{{ mail_server_port[0] }}
						</td>
					</tr>
					{% endif %}
					{% if document is not defined or document.getUserProfile.getUserMailSystem == 'O' %}
					<tr
						<td class="firstRw"></td>
						<td class="firstRw">
							{%trans%}Enable Debug Mode{%endtrans%}: {{ document.getUserProfile.getEnableDebugMode ? 'Yes'|trans : 'No'|trans }}
							<span class="elNote">{%trans%}Enables JavaScript debugging.{%endtrans%}</span>
						</td>
					</tr>
					<tr>
						<td>{%trans%}Folder messages to show{%endtrans%}:</td>
						<td>
							{{ document.getUserProfile.getOutlookMsgsToShow }}
							<span class="elNote">{%trans%}This is the default count for folder messages. Put 0 to read all. To improve performace set a number (e.g 100) in this field.{%endtrans%}</span>
						</td>
					</tr>
					<tr>
						<td>{%trans%}Root folders to exclude{%endtrans%}:</td>
						<td>
							{{ document.getUserProfile.getExcludeOutlookFolders }}
							<span class="elNote">{%trans%}Separate folder names with a comma e.g(Public Folders,Personal Folders).{%endtrans%}</span>
						</td>
					</tr>
					<tr>
						<td>{%trans%}Inbox level folders to exclude{%endtrans%}:</td>
						<td>
							{{ document.getUserProfile.getExcludeOutlookInboxLevel }}
							<span class="elNote">{%trans%}Separate folder names with a comma.{%endtrans%}</span>
						</td>
					</tr>
					{% endif %}
					<tr>
						<td>{%trans%}Notify user{%endtrans%}</td>
						<td>
							{{ document.getUserProfile.getNotifyUser ? 'Yes'|trans : 'No'|trans }} 
							<span class="elNote">({%trans%}Note: When checked the user credentials will be emailed to the user along with a link to DOCOVA.{%endtrans%})</span>
						</td>
					</tr>
				</table>
			</div>
			<div id="tabs-2">
				<table class="elmContainer" cellspacing="0">
					<tr>
						<td class="firstRw">{%trans%}User Theme{%endtrans%}:</td>
						<td class="firstRw">{{ document.getUserProfile.getTheme|replace({'-' : ' '})|title }}</td>
					</tr>
					<tr>
						<td>{%trans%}Workspace Style{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getWorkspaceTheme == 'S' ? 'Standard'|trans : 'Tile View'|trans }}</td>
					</tr>
					{% if is_granted('ROLE_ADMIN') %}
					<tr>
						<td>{% trans %}Can Create Application?{% endtrans %}</td>
						<td>{{ document.getUserProfile.getCanCreateApp ? 'Yes'|trans : 'No'|trans }}</td>
					</tr>
					{% endif %}
{% if false %}{# default date format is set in Global Settings, not need to be used in userprofile for now #}
					<tr>
						<td>{% trans %}Date Entry Format{% endtrans %}</td>
						<td>{{ document.getUserProfile.getUserDateFormat }}</td>
					</tr>
{% endif %}
					<tr>
						<td>{% trans %}Number Entry Format{% endtrans %}:</td>
						<td>{{ document.getUserProfile.getNumberFormat }}</td>
					</tr>
					<tr>
						<td>{%trans%}Locale{%endtrans%} ({%trans%}Language{%endtrans%}):</td>
						<td>
							{% set _language = (document is not defined or not document.getUserProfile ? 'en' : document.getUserProfile.getLanguage) %}
							{% if _language == 'nl' %}{%trans%}Dutch{%endtrans%}{% endif %}
							{% if _language == 'en' %}{%trans%}English{%endtrans%}{% endif %}
							{% if _language == 'fr' %}{%trans%}French{%endtrans%}{% endif %}
							{% if _language == 'de' %}{%trans%}German{%endtrans%}{% endif %}
							{% if _language == 'jp' %}{%trans%}Japanese{%endtrans%}{% endif %}								
							{% if _language == 'es' %}{%trans%}Spanish{%endtrans%}{% endif %}
						</td>
					</tr>
					<tr>
						<td>{%trans%}Time Zone{%endtrans%} ({%trans%}Region{%endtrans%}):</td>
						<td>
							{% set _usertimezone = (document is not defined or not document.getUserProfile ? '' : document.getUserProfile.getTimeZone) %}
							{{ _usertimezone }}
						</td>
					</tr>
					<tr>
						<td>{%trans%}Load Library Folders{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getLoadLibraryFolders ? 'All on start up'|trans : 'When library selected'|trans }}</td>
					</tr>
					<tr>
						<td>{% trans %}Default View Show Option{% endtrans %}: </td>
						<td>{% if document.getUserProfile.getDefaultShowOption == 'C' %}{% trans %}Current versions{% endtrans %}
							{% elseif document.getUserProfile.getDefaultShowOption == 'A' %}{% trans %}All versions{% endtrans %}
							{% elseif document.getUserProfile.getDefaultShowOption == 'P' %}{% trans %}Pending releases{% endtrans %}
							{% endif %}
						</td>
					</tr>
					<tr>
						<td>{% trans %}Max Recent Edit Count{% endtrans %}: </td>
						<td>{{ document.getUserProfile.getRecentEditCount }}</td>
					</tr>
					<tr>
						<td>{% trans %}Max Recent Used App Count{% endtrans %}: </td>
						<td>{{ document.getUserProfile.getRecentUsedAppCount }}</td>
					</tr>
					<tr>
						<td>{% trans %}Logout Link{% endtrans %}:</td>
						<td>{{ document.getUserProfile.getHideLogout ? 'Hide Logout Link'|trans : '' }}</td>
					</tr>
					<tr>
						<td>{% trans %}Redirect to mobile client{% endtrans %}:</td>
						<td>{{ document.getUserProfile.getRedirectToMobile ? 'Auto Redirect'|trans : '' }}</td>
					</tr>
					<tr>
						<td class="hdr" colspan="2">{%trans%}User Experience Attributes{%endtrans%}:</td>
					</tr>
					<tr>
						<td class="firstRw"></td>
						<td class="firstRw">
							<table cellspacing="0" style="width: 100%;">
								<tr>
									<th>{%trans%}Attribute{%endtrans%}</th>
									<th>{%trans%}Value{%endtrans%}</th>
								</tr>
								<tr>
									<td class="firstRw exc">{% if document.getUserProfile.getFltrField1 %}{{ document.getUserProfile.getFltrField1.getTitle }}{% endif %}</td>
									<td class="firstRw exc">{% if document.getUserProfile.getFltrField1 %}{{ document.getUserProfile.getFltrFieldVal1 }}{% endif %}</td>
								</tr>
								<tr>
									<td class="firstRw exc">
										<span class="elNote">{%trans%}and{%endtrans%}</span>
										{% if document.getUserProfile.getFltrField2 %}{{ document.getUserProfile.getFltrField2.getTitle }}{% endif %}
									</td>
									<td class="firstRw exc">
										<span class="elNote">&nbsp;</span>
										{% if document.getUserProfile.getFltrField2 %}{{ document.getUserProfile.getFltrFieldVal2 }}{% endif %}
									</td>
								</tr>
								<tr>
									<td class="firstRw exc">
										<span class="elNote">{%trans%}and{%endtrans%}</span>
										{% if document.getUserProfile.getFltrField3 %}{{ document.getUserProfile.getFltrField3.getTitle }}{% endif %}
									</td>
									<td class="firstRw exc">
										<span class="elNote">&nbsp;</span>
										{% if document.getUserProfile.getFltrField3 %}{{ document.getUserProfile.getFltrFieldVal3 }}{% endif %}
									</td>
								</tr>
								<tr>
									<td class="firstRw exc">
										<span class="elNote">{%trans%}and{%endtrans%}</span>
										{% if document.getUserProfile.getFltrField4 %}{{ document.getUserProfile.getFltrField4.getTitle }}{% endif %}
									</td>
									<td class="firstRw exc">
										<span class="elNote">&nbsp;</span>
										{% if document.getUserProfile.getFltrField4 %}{{ document.getUserProfile.getFltrFieldVal4 }}{% endif %}
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</div>
			<div id="tabs-3">
				<table class="elmContainer" cellspacing="0">
					<tr>
						<td class="firstRw">{%trans%}Title{%endtrans%}:</td>
						<td class="firstRw">{{ document.getUserProfile.getTitle }}</td>
					</tr>
					<tr>
						<td>{%trans%}Department{%endtrans%}</td>
						<td>{{ document.getUserProfile.getDepartment }}</td>
					</tr>
					<tr>
						<td>{%trans%}Manager{%endtrans%}:</td>
						<td>{% if document.getUserProfile.getManager %}{{ document.getUserProfile.getManager.getUserNameDnAbbreviated }}{% endif %}</td>
					</tr>
					<tr>
						<td>{%trans%}Office Phone{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getOfficeNo }}</td>
					</tr>
					<tr>
						<td>{%trans%}Mobile Phone{%endtrans%}:</td>
						<td>{{ document.getUserProfile.getMobileNo }}</td>
					</tr>
					<tr>
						<td>{%trans%}Expertise (skills){%endtrans%}:</td>
						<td>{{ document.getUserProfile.getExpertise }}</td>
					</tr>
				</table>
			</div>
			<div id="tabs-4">
				<table class="elmContainer">
					<tr>
						<td class="firstRw">{%trans%}Delegate Owner{%endtrans%}:</td>
						<td class="firstRw">
							<input type="text" id="DelegateOwner" name="DelegateOwner" value="{{ user.getUserNameDnAbbreviated }}" class="text ui-widget-content ui-corner-all"/>
							<button id="btnDelegateOwner"></button>
							<button id="btnRemoveDelegate" class="delegateBtn">Remove</button>
							<button id="btnAddDelegate" class="delegateBtn">Add</button>
						</td>
					</tr>
					<tr>
						<td class="firstRw exc" colspan="2">
							<div id="divDelegateData" style="background-color: white; height:200px; width:100%; border:1px solid #88aacc; overflow:auto;">
								<div id="NoDelegateDataMsg" style="display:none; font:11px verdana,arial;">{% trans %}There are currently no assigned Delegate for this profile.{% endtrans %}</div>
								<table id="tblDelegateData" class="tblFields" datasrc="#DelegateData" style="table-layout:fixed;border-collapse:collapse;width:100%;">
									<thead class="ui-state-hover">
									<tr>
										<td style="width:20px;"></td>
										<td>{% trans %}Library{% endtrans %}</td>
										<td>{% trans %}Workflow{% endtrans %}</td>
										<td>{% trans %}Start Date{% endtrans %}</td>
										<td>{% trans %}End Date{% endtrans %}</td>
										<td>{% trans %}Delegate{% endtrans %}</td>
										<td>{% trans %}Notifications{% endtrans %}</td>
										<td>{% trans %}Review Policies{% endtrans %}</td>
										<td style="width:40px;"></td>
									</tr>
									</thead>
									<tbody id="otblDelegateData">
									<tr>
										<td><input id="Selected" type="checkbox" datafld="Selected" style="width: 20px;" /></td>
										<td><span datafld="Library" style="font: 11px verdana, Arial; color:#000080;"></span></td>
										<td><span datafld="Workflow" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><span datafld="StartDate" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><span datafld="EndDate" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><span datafld="Delegate" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><span datafld="Notifications" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><span datafld="ReviewPolicies" style="font:11px verdana, Arial; color:#000000;"></span></td>
										<td><button class="btnEditRow"></button></span></td>
									</tr>
									</tbody>
								</table>
							</div>
<script>
	var DelegateData= new xmlDataIsland();
	DelegateData.setSrc ( "{{ path('docvoa_embeddedviews') }}?OpenPage&view=luDelegatesByOwner&restricttocategory={{ user.getUserNameDnAbbreviated|replace({'\\': '\\\\'}) }}&{{ 'now'|date('U') }}" ) ;
	DelegateData.id = "DelegateData";
	DelegateData.setTemplateName( "otblDelegateData");
	DelegateData.ondatasetcomplete = function() { DelegatesLoaded(); }
//	DelegateData.process();
</script>							
						</td>
					</tr>
				</table>
			</div>
		</div>
	</div>
</body>
</html>