<!DOCTYPE HTML>
<html>
<head>
<title>{%trans%}Review Policy{%endtrans%}</title>
{% include 'DocovaBundle:Admin:sfWebAdminCommonScriptHeader.html.twig'%}
{% if document is defined %}
	{% set path_info = path('docova_admin_editdocument', { 'view_name' : view_name, 'doc_id' : document.getId }) %}
{% else %}
	{% set path_info = path('docova_admin_reviewpolicy') %}
{% endif %}

{% include 'DocovaBundle:Admin:sfWebAdminCommonFields.html.twig' with { 
	'document' : document is defined ? document : '', 
	'view_name' : view_name, 
	'view_title' : view_title, 
	'path_info' : path_info,
	'mode' : 'edit'
} %}
<script language="JavaScript" type="text/javascript">
$(function() {
	$('#PolicyName').focus();

	$('#Library').multiselect({
		position: { my: 'left top', at: 'left bottom'},
		selectedList: 3,
		appendTo: "#divFormContainer" 
	});

	$('#DocumentType').multiselect({
		position: { my: 'left top', at: 'left bottom'}, 
		selectedList: 3,
		appendTo: "#divFormContainer" 
	});

	$('#ReviewPeriodOption').on('change', function() {
		if ($(this).val() == 'C') {
			$('#customPrOption').removeClass('hidden');
		}
		else {
			$('#customPrOption').addClass('hidden');
		}
	});

	$('#ReviewDateSelect').on('change', function() {
		if ($(this).val() == 'custom') {
			$('#customReviewDate').removeClass('hidden');
		}
		else {
			$('#customReviewDate').addClass('hidden');
		}
	});	
});
// validate user profile fields before submitting
function validateDocumentFields(){

	msg = "";
	msgPrefix = "{% trans %}Please complete the following fields{% endtrans %}:\r\r";

	if (doc.PolicyName.value == "") {
	    msg += " - {% trans %}Policy Name{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "LibraryOption"}) == "S" && Docova.Utils.getField({field : "Library"}) == "") {
	    msg += " - {% trans %}Select the Applicable Libraries{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "DocumentTypeOption"}) == "S" && Docova.Utils.getField({field : "DocumentType"}) == "") {
	    msg += " - {% trans %}Select the Applicable Document Types{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "DocumentStatusDraft"}) == "" && Docova.Utils.getField({field : "DocumentStatusRelease"}) == "") {
	    msg += " - {% trans %}Document Status{% endtrans %}\r";
	}
	if ($.trim($('#ReviewPeriod').val()) == "") {
	    msg += " - {% trans %}Review Period - 'Repeat every' value{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "UseCustomReviewPeriod"}) == "1" && Docova.Utils.getField({field : "CustomReviewPeriod"}) == "") {
	    msg += " - {% trans %}Enter a field name for Review Period - custom frequency{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "ReviewPeriodOption"}) == "C" && Docova.Utils.getField({field : "CustomReviewPeriodOption"}) == "") {
	    msg += " - {% trans %}Enter a field name for Review Period - custom time scale{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "ReviewDateSelect"}) == "custom" && Docova.Utils.getField({field : "CustomReviewDateSelect"}) == "") {
	    msg += " - {% trans %}Enter a field name for Review Period - custom starting date{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "AuthorReview"}) == "" && Docova.Utils.getField({field : "Reviewers"}) == "") {
	    msg += " - {% trans %}Actions - Specify a reviewer{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "wfEnableActivateMsg"}) == "1" && Docova.Utils.getField({field : "wfActivateNotifyParticipants"}) == "" &&
	    Docova.Utils.getField({field : "wfActivateNotifyField"}) == "" && Docova.Utils.getField({field : "wfActivateNotifyList"}) == "") {
	    msg += " - {% trans %}Actions - 'Send' selected but no recipients defined{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "wfEnableDelayMsg"}) == "1" && Docova.Utils.getField({field : "wfDelayNotifyParticipants"}) == "" &&
	    Docova.Utils.getField({field : "wfDelayNotifyList"}) == "") {
	    msg += " - {% trans %}Delayed Actions - 'Send' selected but no recipients defined{% endtrans %}\r";
	}
	if (Docova.Utils.getField({field : "wfEnableDelayEsclMsg"}) == "1" && Docova.Utils.getField({field : "wfDelayEsclNotifyParticipants"}) == "" &&
	    Docova.Utils.getField({field : "wfDelayEsclNotifyList"}) == "") {
	    msg += " - {% trans %}Delayed Actions (Escalation) - 'Send' selected but no recipients defined{% endtrans %}\r";
	}
	
	if(msg) {
		alert(msgPrefix + msg);
		return false;
	} else {
		return true;
	}
}

</script>
<style type="text/css">
OL { padding-left: 30px; }
#subContainer {
	width: 100%;
	table-layout: fixed;
}
.ui-icon-group {
	background-image: url('{{ asset('bundles/docova/images/icons/vwicn004.gif') }}') !important;
	background-position: center;	
}
</style>
</head>
<body scroll="no">
	<ul class="ui-widget-header actionBar hidetoload">
		<li id="closeBtn">{% trans %}Close{% endtrans %}</li>
		<li id="saveAndCloseBtn">{% trans %}Save and Close{% endtrans %}</li>
	</ul>
	<form method="post" action="{{ path_info }}" class="hidetoload" autocomplete="off">
		<div id="divFormContainer">
			<table class="elmContainer" cellspacing="0">
				<tr>
					<td colspan="2" class="firstRw"><h3 class="headings1">{% trans %}Review Policy Settings{% endtrans %}</h3></td>
				</tr>
				<tr>
					<td class="firstRw">{%trans%}Policy Name{%endtrans%}:</td>
					<td class="firstRw"><input type="text" id="PolicyName" name="PolicyName" value="{{ document is defined ? document.getPolicyName : '' }}" class="text ui-widget-content ui-corner-all"/></td>
				</tr>
				<tr>
					<td>{%trans%}Description{%endtrans%}:</td>
					<td><input type="text" name="Description" value="{{ document is defined ? document.getDescription : '' }}" class="text ui-widget-content ui-corner-all"/></td>
				</tr>
				<tr>
					<td>{%trans%}Status{%endtrans%}:</td>
					<td>
						<label><input type="radio" name="PolicyStatus" value="1" {{ document is not defined or document.getPolicyStatus ? 'checked' : '' }}> {%trans%}Active{%endtrans%}</label>
						<label><input type="radio" name="PolicyStatus" value="0" {{ document is defined and not document.getPolicyStatus ?'checked':'' }}> {%trans%}Inactive{%endtrans%} </label>
					</td>
				</tr>
				<tr>
					<td>{%trans%}Priority{%endtrans%}:</td>
					<td>
						<label><input type="radio" name="PolicyPriority" value="3" {{ document is defined and document.getPolicyPriority == 3 ? 'checked' : '' }} > {%trans%}Low{%endtrans%}</label>
						<label><input type="radio" name="PolicyPriority" value="2" {{ document is not defined or document.getPolicyPriority == 2 ? 'checked' : '' }} > {%trans%}Med{%endtrans%}</label>
						<label><input type="radio" name="PolicyPriority" value="1" {{ document is defined and document.getPolicyPriority == 1 ? 'checked' : '' }} > {%trans%}High{%endtrans%}</label>
					</td>
				</tr>
				<tr>
					<td>{%trans%}Applicable Libraries{%endtrans%}:</td>
					<td>
						<label><input type="radio" name="LibraryOption" class="hideShow" hide="libs" value="A" {{ document is not defined or document.getLibraries.count == 0 ? 'checked' : '' }}> {%trans%}All{%endtrans%}</label>
						<label><input type="radio" name="LibraryOption" class="hideShow" show="libs" value="S" {{ document is defined and document.getLibraries.count > 0 ? 'checked' : '' }}> {%trans%}Selected{%endtrans%}</label>
					</td>
				</tr>
				<tr class="libs{% if document is not defined or document.getLibraries.count == 0 %} hidden{% endif %}">
					<td class="firstRw"></td>
					<td class="firstRw">						
						<select id="Library" name="Library[]" multiple="multiple">
						{% if libraries is defined and libraries|length %}
							{% for item in  libraries %}
								{% set selected = '' %}
								{% if document is defined and document.getLibraries.count > 0 %}
									{% for selLibrary in document.getLibraries %}
										{% if selLibrary.id == item.getId %}
											{% set selected = 'selected="selected"' %}
										{% endif %}
									{% endfor %}
								{% endif %}
							<option {{ selected }} value="{{ item.getId }}" >{{ item.getLibraryTitle }}</option>
							{% endfor %}
						{% endif %}
						</select>					
					</td>
				</tr>
				<tr>
					<td>{%trans%}Applicable Document Types{%endtrans%}:</td>
					<td>
						<label><input type="radio" name="DocumentTypeOption" class="hideShow" hide="doctypes" value="A" {{ document is not defined or document.getDocumentTypes.count == 0 ? 'checked' : '' }}/> {%trans%}All{%endtrans%}</label>
						<label><input type="radio" name="DocumentTypeOption" class="hideShow" show="doctypes" value="S" {{ document is defined and document.getDocumentTypes.count > 0 ? 'checked' : '' }}/> {%trans%}Selected{%endtrans%}</label>
					</td>
				</tr>
				<tr class="doctypes{% if document is not defined or document.getDocumentTypes.count == 0 %} hidden{% endif %}">
					<td class="firstRw"></td>
					<td class="firstRw">
						<select id="DocumentType" name="DocumentType[]" multiple="multiple">
						{% if doctypes is defined and doctypes|length %}
							{% for item in  doctypes %}
								{% set selected = '' %}
								{% if document is defined and document.getDocumentTypes.count > 0 %}
									{% for selDocType in document.getDocumentTypes %}
										{% if selDocType.id == item.getId %}
											{% set selected = 'selected="selected"' %}
										{% endif %}
									{% endfor %}
								{% endif %}
							<option {{ selected }} value="{{ item.getId }}" >{{ item.getDocName }}</option>
							{% endfor %}
						{% endif %}
						</select>					
					</td>
				</tr>
				<tr>
					<td>{%trans%}Document Status{%endtrans%}:</td>
					<td>
						<label><input type="checkbox" name="DocumentStatusDraft" value="1" {{ document is defined and (document.getDocumentStatus == 1 or document.getDocumentStatus == 3) ?'checked':'' }}/> {%trans%}Draft/Not Released{%endtrans%}</label>
						<label><input type="checkbox" name="DocumentStatusRelease" value="1" {{ document is defined and document.getDocumentStatus > 1 ?'checked':'' }}/> {%trans%}Released{%endtrans%}</label>
					</td>
				</tr>
				<tr>
					<td>{%trans%}Custom selection criteria{%endtrans%}:</td>
					<td>
						<textarea name="ReviewCustomFormula" class="text ui-widget-content ui-corner-all">{{ document is defined ? document.getReviewCustomFormula : "" }}</textarea>
						<span class="elNote">{%trans%}Optional Doctrine DQL where clause for a select from document table. "D" refers to Document; "CU" refers to Creator; "AU" refers to Authors.{%endtrans%}</span>
						<span class="elNote">{%trans%}e.g. "D.Doc_Title = 'my_value' AND (CU.userNameDnAbbreviated = 'DLI Tools/DOCOVA' OR AU.userNameDnAbbreviated = 'DLI Tools/DOCOVA')"{%endtrans%}</span>
					</td>
				</tr>
				<tr>
					<td>{%trans%}Review period{%endtrans%}:</td>
					<td>
						<table id="subContainer" cellpadding="0">
							<tr>
								<td class="firstRw exc" style="width:50%">
									{%trans%}Repeat every{%endtrans%}
									<input type="text" name="ReviewPeriod" id="ReviewPeriod" value="{{ document is defined ? document.getReviewPeriod : '1' }}" class="text ui-widget-content ui-corner-all numeric" /> 
									{% trans %}or{% endtrans %}
									<label><input type="checkbox" name="UseCustomReviewPeriod" value="1" class="hideShow" show="customPeriod" {{ document is defined and document.getCustomReviewPeriod ? 'checked' : '' }} /> {%trans%}custom{%endtrans%}</label>
									<div style="padding-top: 5px;" class="customPeriod{% if document is not defined or not document.getCustomReviewPeriod %} hidden{% endif %}">
										<input type="text" name="CustomReviewPeriod" value="{{ document is defined ? document.getCustomReviewPeriod : '' }}" class="text ui-widget-content ui-corner-all" />
										<span class="elNote">{%trans%}Enter the name of a field on the document that will determine the frequency of the review period.{%endtrans%}</span>
									</div>
								</td>
								<td class="firstRw">
									<select id="ReviewPeriodOption" name="ReviewPeriodOption" class="text ui-widget-content ui-corner-all smCombo">
										<option value="D" {{ document is defined and document.getReviewPeriodOption == 'D' ? 'selected' : '' }}>{%trans%}day(s){%endtrans%}
										<option value="W" {{ document is defined and document.getReviewPeriodOption == 'W' ? 'selected' : '' }}>{%trans%}week(s){%endtrans%}
										<option value="M" {{ document is defined and document.getReviewPeriodOption == 'M' ? 'selected' : '' }}>{%trans%}month(s){%endtrans%}
										<option value="Y" {{ document is not defined or document.getReviewPeriodOption == 'Y' ? 'selected' : '' }}>{%trans%}year(s){%endtrans%}
										<option value="C" {{ document is defined and document.getReviewPeriodOption == 'C' ? 'selected' : '' }}>{%trans%}custom{%endtrans%}
									</select>
									<div style="padding-top: 5px;" id="customPrOption" {% if document is not defined or document.getReviewPeriodOption != 'C' %}class="hidden"{% endif %}>
										<input type="text" name="CustomReviewPeriodOption" value="{{ document is defined ? document.getCustomReviewPeriodOption : '' }}" class="text ui-widget-content ui-corner-all" />										
										<span class="elNote">{%trans%}Enter the name of a field on the document that will determine the time scale of the review period.{%endtrans%}
										{%trans%}The field must contain a value that corresponds to the following list{%endtrans%}:</span> 
										<span class="elNote">{%trans%}D = day(s); W = week(s); M = month(s); Y = year(s){%endtrans%}</span> 
									</div>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td>
						{%trans%}Starting from{%endtrans%} 
						<select id="ReviewDateSelect" name="ReviewDateSelect" class="text ui-widget-content ui-corner-all">
							<option value="LastReviewDate" {{ document is not defined or document.getReviewDateSelect == 'LastReviewDate' ? 'selected' : '' }} />{%trans%}last review date{%endtrans%}
							<option value=DateCreated {{ document is defined and document.getReviewDateSelect == 'DateCreated' ? 'selected' : '' }} />{%trans%}created{%endtrans%}
							<option value="DateModified" {{ document is defined and document.getReviewDateSelect == 'DateModified' ? 'selected' : '' }} />{%trans%}last modified{%endtrans%}
							<option value="ReleasedDate" {{ document is defined and document.getReviewDateSelect == 'ReleasedDate' ? 'selected' : '' }} />{%trans%}released{%endtrans%}
							<option value="custom" {{ document is defined and document.getReviewDateSelect == 'custom' ? 'selected' : '' }}>{%trans%}custom{%endtrans%}
						</select>
					</td>
				</tr>
				<tr id="customReviewDate" class="{% if document is not defined or document.getReviewDateSelect != 'custom' %}hidden{% endif %}">
					<td class="firstRw"></td>
					<td class="firstRw">
						<span class="elNote">{%trans%}Enter the name of a field on the document that will determine the starting date of the review period.{%endtrans%}</span>
						<input type="text" name="CustomReviewDateSelect" value="{{ document is defined ? document.getCustomReviewDateSelect : '' }}" class="text ui-widget-content ui-corner-all" />
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td>
						<span class="elNote">{%trans%}In case the date field specified above has no value, the process will pick the first non-empty date in the following order{%endtrans%}:</span>
						<ol type="1">
							<li><span class="elNote">{%trans%}last review date{%endtrans%}</span></li>
							<li><span class="elNote">{%trans%}Released Date{%endtrans%}</span></li>
							<li><span class="elNote">{%trans%}Created Date{%endtrans%}</span></li>
						</ol> 
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						<label><input type="checkbox" name="ReviewStartDayOption" value="1" {{ document is defined and document.getReviewStartDayOption ?'checked':'' }}/> {%trans%}Reference periods to{%endtrans%}</label>
						<select name="ReviewStartMonth" class="text ui-widget-content ui-corner-all smCombo">
							<option value="1"  {% if document is defined %} {{ document.getReviewStartMonth == 1 ? "selected":"" }}{% else %} selected{% endif %}>{%trans%}Jan{%endtrans%}
							<option value="2"  {% if document is defined %} {{ document.getReviewStartMonth == 2 ? "selected":"" }}{% endif %}>{%trans%}Feb{%endtrans%}
							<option value="3"  {% if document is defined %} {{ document.getReviewStartMonth == 3 ? "selected":"" }}{% endif %}>{%trans%}Mar{%endtrans%}
							<option value="4"  {% if document is defined %} {{ document.getReviewStartMonth == 4 ? "selected":"" }}{% endif %}>{%trans%}Apr{%endtrans%}
							<option value="5"  {% if document is defined %} {{ document.getReviewStartMonth == 5 ? "selected":"" }}{% endif %}>{%trans%}May{%endtrans%}
							<option value="6"  {% if document is defined %} {{ document.getReviewStartMonth == 6 ? "selected":"" }}{% endif %}>{%trans%}Jun{%endtrans%}
							<option value="7"  {% if document is defined %} {{ document.getReviewStartMonth == 7 ? "selected":"" }}{% endif %}>{%trans%}Jul{%endtrans%}
							<option value="8"  {% if document is defined %} {{ document.getReviewStartMonth == 8 ? "selected":"" }}{% endif %}>{%trans%}Aug{%endtrans%}
							<option value="9"  {% if document is defined %} {{ document.getReviewStartMonth == 9 ? "selected":"" }}{% endif %}>{%trans%}Sep{%endtrans%}
							<option value="10" {% if document is defined %} {{ document.getReviewStartMonth == 10 ? "selected":"" }}{% endif %}>{%trans%}Oct{%endtrans%}
							<option value="11" {% if document is defined %} {{ document.getReviewStartMonth == 11 ? "selected":"" }}{% endif %}>{%trans%}Nov{%endtrans%}
							<option value="12" {% if document is defined %} {{ document.getReviewStartMonth == 12 ? "selected":"" }}{% endif %}>{%trans%}Dec{%endtrans%}
						</select> 
						<select name="ReviewStartDay" class="text ui-widget-content ui-corner-all smCombo">
						{% for x in 1..31 %}
							<option value="{{ x }}" {{ document is defined and document.getReviewStartDay == x ? 'selected' : '' }}	>{{ x }}</option>
						{% endfor %}
						</select>
					</td>
				</tr>
				<tr>
					<td>{% trans %}Actions{% endtrans %}:</td>
					<td>
						{%trans%}Create and assign a review action item to{%endtrans%}:<br />
						<label><input type="checkbox" name="AuthorReview" value="1" {{ document is defined and document.getAuthorReview ?'checked':'' }} /> {%trans%}Document author{%endtrans%}</label><br />
						<label><input type="checkbox" name="AdditionalEditorReview" value="1" {{ document is defined and document.getAdditionalEditorReview ? 'checked' : '' }} /> {%trans%}Additional Editors entered on the document{%endtrans%}</label>
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{% trans %}and/or{% endtrans %}
						<input type="text" name="wfReviewersField" value="{{ document is defined ? document.getReviewersField : '' }}" class="text ui-widget-content ui-corner-all" />
						<span class="elNote">({%trans%}field on the document containing names to assign the review action to{%endtrans%})</span>
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
                        {%trans%}and/or{%endtrans%}:</br>
						{% set reviewers = '' %}
						{% set reviewers_html = '' %}
						{% if document is defined and document.getReviewers.count > 0 %}
							{% for rw in document.getReviewers %}
								{% set reviewers = rw.getUserNameDnAbbreviated ~ ',' ~ reviewers %}
								{% set reviewers_html = reviewers_html ~ '<span>'+ rw.getUserNameDnAbbreviated +'<i class="far fa-times removename"></i></span>' %}
							{% endfor %}
							{% set reviewers = reviewers[:reviewers|length - 1] %}
						{% endif %}
						<input type="text" class="text ui-widget-content ui-corner-all namepicker" target="Reviewers" elmtype="multi" value="" />
						<button class="show-namepicker" type="button"></button>
						<input type="hidden" name="Reviewers" id="Reviewers" value="{{ reviewers }}" />
						{% if reviewers %}
						<em class="slContainer" id="slContainerreviewers">{{ reviewers_html }}</em>
						{% endif %}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}Notify the following that a review is now pending{%endtrans%}:<br />
						<label><input type="checkbox" name="wfEnableActivateMsg" value="1" {{ document is defined and document.getEnableActivateMsg ? 'checked' : '' }} /> {%trans%}Send{%endtrans%}</label> 
						<select name="wfActivateMsg" class="text ui-widget-content ui-corner-all">
							<option {{ document is not defined or (document.getEnableActivateMsg and document.getEnableActivateMsg.getMessageName == 'DEFAULT_REVIEWACTIVATE') ? 'selected' : '' }} value="D">{%trans%}Default{%endtrans%}</option>
						{% if system_messages|length > 0 %}
							{% for item in system_messages %}
							<option value="{{ item.getId }}" {{ document is defined and document.getEnableActivateMsg and document.getEnableActivateMsg.getId == item.getId ? 'selected' : '' }}>{{ item.getMessageName }}
							{% endfor %}
						{% endif %}
						</select> 
						{%trans%}message{%endtrans%}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{% trans %}to{% endtrans %}: 
						<label><input type="checkbox" name="wfActivateNotifyParticipants" value="P" {{ document is defined and document.getActivateNotifyParticipants ? 'checked' : '' }}> {%trans%}document author / all reviewers named above{%endtrans%}</label>
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{% trans %}and/or{% endtrans %}:<br />
						<input type="text" name="wfActivateNotifyField" value="{{ document is defined ? document.getActivateNotifyField : '' }}" class="text ui-widget-content ui-corner-all" />
						<span class="elNote"> ({%trans%}field on the document containing names to send the review action to{%endtrans%})</span>
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}and/or{%endtrans%}:</br>
						{% set activate_notify_list = '' %}
						{% set anl_html = '' %}
						{% if document is defined and document.getActivateNotifyList.count > 0 %}
							{% for actnl in document.getActivateNotifyList %}
								{% set activate_notify_list = actnl.getUserNameDnAbbreviated ~ ',' ~ activate_notify_list %}
								{% set anl_html = anl_html ~ '<span>'~ actnl.getUserNameDnAbbreviated ~'<i class="far fa-times removename"></i></span>' %}
							{% endfor %}
							{% set activate_notify_list = activate_notify_list[:activate_notify_list|length - 1] %}
						{% endif %}
						<input type="text" class="text ui-widget-content ui-corner-all namepicker" target="wfActivateNotifyList" elmtype="multi" value="" />
						<button class="show-namepicker" type="button"></button>
						<input type="hidden" name="wfActivateNotifyList" id="wfActivateNotifyList" value="{{ activate_notify_list }}" />
						{% if activate_notify_list %}
						<em class="slContainer" id="slContainerwfactivatenotifylist">{{ anl_html }}</em>
						{% endif %}
					</td>
				</tr>
				<tr>
					<td>{%trans%}Action options{%endtrans%}:</td>
					<td>
						{%trans%}Create actions{%endtrans%} 
						<input type="text" name="ReviewAdvance" value="{{ document is defined ? document.getReviewAdvance : 1 }}" class="text ui-widget-content ui-corner-all numeric" />
						{%trans%}day(s) ahead of due date.{%endtrans%}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}Skip first review if it falls within{%endtrans%} 
						<input type="text" name="ReviewGracePeriod" value="{{ document is defined ? document.getReviewGracePeriod : 30 }}" class="text ui-widget-content ui-corner-all numeric"> 
						{%trans%}day(s) of document release.{%endtrans%}
					</td>
				</tr>
				<tr>
					<td>{%trans%}Delayed actions{%endtrans%}:</td>
					<td>
						{%trans%}If not completed within{%endtrans%}: 
						<input type="text" name="wfDelayCompleteThreshold" value="{{ document is defined ? document.getDelayCompleteThreshold : 3 }}" class="text ui-widget-content ui-corner-all numeric"> {%trans%}day(s){%endtrans%}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						<label><input type="checkbox" name="wfEnableDelayMsg" value="1" {{ document is defined and document.getEnableDelayMsg ? 'checked' : '' }} class="inpRadioChkbox" /> {%trans%}Send{%endtrans%}</label> 
						<select name="wfDelayMsg" class="text ui-widget-content ui-corner-all">
							<option value="D" {{ document is not defined or (document.getEnableDelayMsg and document.getEnableDelayMsg.getMessageName == 'DEFAULT_DELAY') ? 'selected' : '' }}>{%trans%}Default{%endtrans%}</option>
							{% if system_messages|length > 0 %}
								{% for item in system_messages %}
							<option value="{{ item.getId }}" {{ document is defined and document.getEnableDelayMsg and document.getEnableDelayMsg.getId == item.getId ? 'selected' : '' }}>{{ item.getMessageName }}
								{% endfor %}
							{% endif %}
						</select> 
						{%trans%}message{%endtrans%}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}to{%endtrans%}: 
						<label><input type="checkbox" name="wfDelayNotifyParticipants" value="P" {{ document is defined and document.getDelayNotifyParticipants ? 'checked' : '' }} /> {%trans%}Reviewers{%endtrans%}</label><br />
						{% set delay_notify_list = '' %}
						{% set dnl_html = '' %}
						{% if document is defined and document.getDelayNotifyList.count > 0 %}
							{% for dl in document.getDelayNotifyList %}
								{% set delay_notify_list = dl.getUserNameDnAbbreviated ~ ',' ~ delay_notify_list %}
								{% set dnl_html = dnl_html ~ '<span>'~ dl.getUserNameDnAbbreviated ~'<i class="far fa-times removename"></i></span>' %}
							{% endfor %}
							{% set delay_notify_list = delay_notify_list[:delay_notify_list|length - 1] %}
						{% endif %}
						<input type="text" class="text ui-widget-content ui-corner-all namepicker" target="wfDelayNotifyList" elmtype="multi" value="" />
						<button class="show-namepicker" type="button"></button>
						<input type="hidden" name="wfDelayNotifyList" id="wfDelayNotifyList" value="{{ delay_notify_list }}" />
						{% if delay_notify_list %}
						<em class="slContainer" id="slContainerwfdelaynotifylist">{{ dnl_html }}</em>
						{% endif %}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}If not completed within further{%endtrans%}: 
						<input type="text" name="wfDelayEsclThreshold" value="{{ document is defined ? document.getDelayEsclThreshold : 3 }}" class="text ui-widget-content ui-corner-all numeric"/> {% trans %}day(s){% endtrans %}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						<label><input type="checkbox" name="wfEnableDelayEsclMsg" value="1" {{ document is defined and document.getEnableDelayEsclMsg ? 'checked' : '' }} /> {%trans%}send{%endtrans%}</label>
						<select name="wfDelayEsclMsg" class="text ui-widget-content ui-corner-all">
							<option value="D" {{ document is not defined or (document.getEnableDelayEsclMsg and document.getEnableDelayEsclMsg.getMessageName == 'DEFAULT_DELAYESCL') ? 'selected' : '' }}>{%trans%}Default{%endtrans%}</option>
							{% if system_messages|length > 0 %}
								{% for item in system_messages %}
							<option value="{{ item.getId }}" {{ document is defined and document.getEnableDelayEsclMsg and document.getEnableDelayEsclMsg.getId == item.getId ? 'selected' : '' }}>{{ item.getMessageName }}
								{% endfor %}
							{% endif %}
						</select> 
						{%trans%}escalation message{%endtrans%}
					</td>
				</tr>
				<tr>
					<td class="firstRw"></td>
					<td class="firstRw">
						{%trans%}to{%endtrans%}: 
						<label><input type="checkbox" name="wfDelayEsclNotifyParticipants" value="P" {{ document is defined and document.getDelayEsclNotifyParticipant ? 'checked' : '' }} /> {%trans%}reviewers{%endtrans%} </label></br>
						{% set delay_escl_list = '' %}
						{% set del_html = '' %}
						{% if document is defined and document.getDelayEsclNotifyList.count > 0 %}
							{% for escl in document.getDelayEsclNotifyList %}
								{% set delay_escl_list = escl.getUserNameDnAbbreviated ~ ',' ~ delay_escl_list %}
								{% set del_html = del_html ~ '<span>'~ escl.getUserNameDnAbbreviated ~'<i class="far fa-times removename"></i></span>' %}
							{% endfor %}
							{% set delay_escl_list = delay_escl_list[:delay_escl_list|length - 1] %}
						{% endif %}
						<input type="text" class="text ui-widget-content ui-corner-all namepicker" target="wfDelayEsclNotifyList" elmtype="multi" value="" />
						<button class="show-namepicker" type="button"></button>
						<input type="hidden" name="wfDelayEsclNotifyList" id="wfDelayEsclNotifyList" value="{{ delay_escl_list }}" />
						{% if delay_escl_list %}
						<em class="slContainer" id="slContainerwfdelayesclnotifylist">{{ del_html }}</em>
						{% endif %}
					</td>
				</tr>
			</table>
		</div>
	</form>
</body>
</html>
