{% set date_format = settings.getDefaultDateFormat|replace({'MM' : 'm', 'DD' : 'd', 'YYYY' : 'Y'}) %}
<script type="text/javascript">
   var docInfo = {
     "DocID":"{{ document.getId }}",
     "DocKey":"{{ document.getId }}",
     "DocumentNumber":"",
     "ThreadKey":"",
     "DocumentTypeKey":"{{ document.getDocType.getId }}",
     "DocTitle":"{{ document.getDocTitle }}",
     "DocumentType":"{{ document.getDocType.getDocName }}",
     "LibraryKey":"{{ document.getFolder.getLibrary.getId }}",
     "LibraryTitle":"{{ document.getFolder.getLibrary.getLibraryTitle }}",
     "SystemKey":"DOMT-9ALLV6",
     "UserName":"{{ user.username }}",
     "UserNameAB":"{{ user.username }}",
     "UserNameCN":"{{ user.username }}",
     "TodayDate":"{{ 'now'|date(date_format) }}",
     "isNewDoc":"",
     "isDocBeingEdited":"",
     "CursorFocusField":"Subject",
     "DocAccessLevel":"6",
     "CanDeleteDocuments":"true",
     "DocAccessRole":"Manager",
     "DbAccessLevel":"3",
     "CanCreateRevisions":"true",
     "Mode":"dle",
     "LoadAction":"",
     "DataDocUrl":"{{ url('docova_allbydockey', {'key' : document.getFolder.getId}) }}",
     "HTTP_Referer":"{{ url('docova_mobile') }}",
     "Query_String":"OpenDocument&ParentUNID={{ document.getFolder.getId }}&Mobile=true&device=&_=1380912998309",
     "Query_String_Decoded":"OpenDocument&ParentUNID={{ document.getFolder.getId }}&Mobile=true&device=&_=1380912998309",
     "Path_Info_Decoded":"{{ path('docova_readdocument', { 'doc_id' : document.getId}) }}?OpenDocument&ParentUNID={{ document.getFolder.getId }}&Mobile=true&device=&_=1380912998309",
     "SSLState":"{% if app.request.getscheme == 'https' %}ON{% endif %}",
     "ServerName":"{{ app.request.server.get('HTTP_HOST') }}",
     "ServerUrl":"{{ app.request.getscheme }}://{{ app.request.server.get('HTTP_HOST') }}",
     "NsfName":"{{ path('docova_mobile')[1:path('docova_homepage')|length - 2] }}",
     "LogNsfName":"{{ path('docova_mobile')[:path('docova_mobile')|length] }}",
     "ArchiveNsfName":"/mobile/Documents_A.nsf",
     "PortalWebPath":"{{ path('docova_mobile')[:path('docova_homepage')|length - 1] }}",
     "PortalNsfName":"{{ path('docova_mobile')[1:path('docova_mobile')|length - 1] }}",
     "KeywordsNsfName":"mobile/DocovaKeywords.nsf",
     "KeywordsWebName":"/mobile/DocovaKeywords.nsf",
     "FolderID":"{{ document.getFolder.getID }}",
     "FolderName":"{{ document.getFolder.getFolderName }}",
     "FolderAncestors":"",
     "FolderPath":"{{ document.getFolder.getFolderName }}",
     "CreatedBy":"{{ document.getCreator.getUsername }}",
     "CreatedDate":"{{ document.getDateCreated|date('d/m/Y') }}",
     "Managers":"[Administration], DV Dlitools/mobile/docovanet",
     "Authors":"[Administration], DV Dlitools/mobile/docovanet, DV Dlitools/mobile/docovanet, {{ document.getCreator.getUsername }}",
     "Readers":"",
     "FolderAuthors":"",
     "FolderReaders":"",
     "FolderDocTypes":"",
     "LastModifiedBy":"{% if document.getModifier|length > 0 %}{{ document.getModifier.getUsername }}{% endif %}",
     "LastModifiedDate":"{% if document.getDateModified|length > 0 %}{{ document.getDateModified|date(date_format) }}{% endif %}",
     "LastModifiedServer":"domino-100.docova.net/docovanet",
     "isReplicated":"{% if workflows|length > 0 %}true{% endif %}",
     "LockEditor":"",
     "LockDate":"",
     "LockServer":"",
     "LockStatus":"0",
     "isLockEditor":"",
     "isLocked":"",
     "isEditable":"true",
     "isFileCIAOEnabled":"",
     "isFileViewLoggingOn":"",
     "isFileDownloadLoggingOn":"",
     "MaxFiles":"1",
     "AllowedFileExtensions":"",
     "AttachmentsReadOnly":"",
     "AttachmentsHidden":"",
     "EnableDiscussion":"true",
     "EnableLocalScan":"true",
     "EnableMailAcquire":"true",
     "EnableDropboxAcquire":"",
     "EnableLinkedFiles":"",
     "LaunchLinkedFiles":"",
     "RestrictPrinting":"",
     "RequirePDFCreator":"",
	 "TemplateList" : "{{ templates['Template_List'] is defined ? templates['Template_List'] : '' }}",
	 "TemplateNameList" : "{{ templates['Template_Name_List'] is defined ? templates['Template_Name_List'] : '' }}",
	 "TemplateFileList" : "{{ templates['Template_File_List'] is defined ? templates['Template_File_List'] : '' }}",
	 "TemplateVersionList" : "{{ templates['Template_Version_list'] is defined ? templates['Template_Version_list'] : '' }}",
	 "TemplateType" : "{{ templates['Template_Type'] is defined ? templates['Template_Type'] : '' }}",
	 "TemplateAutoAttach" : "{{ templates['Template_Auto_Attach'] is defined ? templates['Template_Auto_Attach'] : '' }}",
     "HasWorkflow":"{% if workflows|length > 0 %}true{% endif %}",
     "HasLifecycle":"{% if workflows|length > 0 %}true{% endif %}",
     {% if workflow_options|length > 0 %}
     "isWorkflowCreated":"{% if workflow_options.isCreated == true %}true{% endif %}",
     "isWorkflowCompleted":"{% if workflow_options.isCompleted == true %}true{% endif %}",
     "CreateWorkflowInDraft":"{% if workflow_options.createInDraft == true %}true{% endif %}",
     {% else %}
     "isWorkflowCreated":"true",
     "isWorkflowCompleted":"",
     "CreateWorkflowInDraft":"true",
     {% endif %}
     "EnableVersions":"true",
     "isXLinkEnabled":"",
     "Version":"0.0",
     "FullVersion":"{{ document.getDocVersion }}",
     "PreviousFullVersion":"",
     "NextFullVersion":"",
     "AvailableVersionList":"1.0.0,0.1.0,0.0.1",
     "isInitialVersion":"true",
     "isSupersededVersion":"",
     "isDiscardedVersion":"",
      "isCurrentVersion":"",
      "isNewVersion":"true",
      "StrictVersioning":"",
      "AllowRetract":"",
      "RestrictDrafts":"",
      "RestrictLiveDrafts":"",
      "HasAttachmentsSection":"",
      "HasMultiAttachmentSections":"",
      "TextContentType":"{% if document.getDocType.getDocName == 'Mail Memo' %}HTML{% else %}TEXT{% endif %}",
      "MailAcquireDialogUrl":"/mobile/Documents.nsf/dlgOutlookMailAcquire?OpenForm",
      "RelatedDocOpenMode":"{{ rel_doc_settings['RelatedDocOpenMode'] is defined and rel_doc_settings['RelatedDocOpenMode'] == 1 ? 'true' : '' }}",
      "OMUserSelectDocTypeKey":"",
      "OMLatestDocTypeKey":"",
      "OMLinkedDocTypeKey":"",
      "MailAcquireMessagesDialogUrl":"/mobile/Documents.nsf/dlgOutlookMailAcquireMessages?OpenForm&ParentUNID=242EDEA0484EF1E586257BF7007A871F",
      "UserMailSystem":"{% if document.getDocType.getDocName == 'Mail Memo' %}O{% else %}N{% endif %}",
      "UserMailImport":"{% if document.getDocType.getDocName == 'Mail Memo' %}O{% endif %}",
      {% set attachments = '' %}
      {% set outlook_file_size = '' %}
      {% if document.getAttachments.count > 0 %}
      	{% for attach in document.getAttachments %}
      		{% set attachments = attachments ~ '*' ~ attach.getFileName %}
      		{% set outlook_file_size = outlook_file_size ~ ',' ~ attach.getFileName ~ '*' ~ ((attach.getFileSize / 1024)|number_format) ~ ' KB' %}
      	{% endfor %}
      	{% set attachments = attachments[1:] %}
      	{% set outlook_file_size = outlook_file_size[1:] %}
      {% endif %}
      "OutlookAttachmentsSize":"{{ outlook_file_size }}",
      "DocAttachmentNames":"{{ attachments }}",
      "SessionDateFormat":"mm/dd/yyyy",
      "isLinkComments":"",
      "hasDrafts":"{{ user.username }}",
      "isBookmark":"",
      "BookmarkParentDocKey":"",
      "DisableBookmarks":"",
      "DocIsDeleted":"",
      "MBThemeTitleBar": "a",
      "MBThemeFolders": "c",
      "MBThemeDocuments": "c",
      "isMobileWorkflowSave":"0",
     "MobileAppDevice":""
    };
</script>